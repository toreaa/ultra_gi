# Story 7.2: Visualiser inntak vs ubehag

## Status
**Draft**

## Story
**As a** user, **I want** to see a graph showing my carb intake over time with discomfort events, **so that** I can identify correlations.

## Acceptance Criteria
1. Økt-detaljskjerm har "Se graf"-knapp → Åpne graf-view
2. Graf viser (Victory Native): X-akse (tid i minutter), Y-akse primær (kumulativt karb-inntak), Y-akse sekundær (ubehag nivå 1-5)
3. Karb-inntak vises som: Linje-graf (kumulativ), Vertikal linje ved hvert inntak
4. Ubehag vises som: Røde punkter, Størrelse/farge tilsvarer nivå
5. Mål-linje (hvis planlagt): Stiplet linje for ideelt kumulativt inntak
6. Zoom/scroll for lange økter (> 2 timer)
7. Legende: "Karb-inntak" | "Ubehag" | "Mål"

## Tasks / Subtasks
- [ ] Create `src/components/analysis/IntakeDiscomfortChart.tsx`
- [ ] Install and configure victory-native
- [ ] Transform session_events to chart data (cumulative intake, discomfort points)
- [ ] Implement VictoryChart with VictoryLine (intake), VictoryScatter (discomfort)
- [ ] Add target line if planned session
- [ ] Add zoom/pan for long sessions (VictoryZoomContainer)
- [ ] Test with real session data (3+ intake, 2+ discomfort events)

## Dev Notes
**Victory Native Implementation [Source: architecture/tech-stack.md#data-visualization]:**
```typescript
import { VictoryChart, VictoryLine, VictoryScatter, VictoryAxis, VictoryLegend } from 'victory-native';

const cumulativeIntake = events
  .filter(e => e.event_type === 'intake')
  .reduce((acc, e) => {
    const carbs = JSON.parse(e.data_json).carbs_consumed;
    acc.push({ x: e.timestamp_offset_seconds / 60, y: (acc[acc.length-1]?.y || 0) + carbs });
    return acc;
  }, []);

const discomfortPoints = events
  .filter(e => e.event_type === 'discomfort')
  .map(e => ({
    x: e.timestamp_offset_seconds / 60,
    y: JSON.parse(e.data_json).level
  }));

<VictoryChart>
  <VictoryLine data={cumulativeIntake} style={{data: {stroke: '#2196F3'}}} />
  <VictoryScatter data={discomfortPoints} size={(d) => d.y * 2} style={{data: {fill: '#D32F2F'}}} />
</VictoryChart>
```

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-23 | 1.0 | Initial story | Bob (SM) |

## Dev Agent Record
*To be filled*

## QA Results
*To be filled*
